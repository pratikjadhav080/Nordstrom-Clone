<!DOCTYPE html>
<html lang="en">

<head>
     <meta charset="UTF-8">
     <meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>My Account | Nordstrom</title>
     <link rel="icon" href="https://n.nordstrommedia.com/id/c4fb2a09-3657-4161-9b79-6412897d9399.png"
          type="image/x-icon" />
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
     <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">
     <link rel="stylesheet" href="/css/myaccount.css" type="text/css" />

     <link rel="stylesheet" href="/css/navbar_footer.css" type="text/css" />

     <script src="/js/navbar.js"> </script>
     <style>
          .list-group-item:nth-child(1) {
               border-radius: 0px;
          }

          .mb-1 {
               margin-left: 10px;
          }

          .border {
               border: 1px solid whitesmoke;
          }

          .padding {
               padding: 10px;
               gap: 10px;
          }

          .flex {
               display: flex;
               flex-direction: column;
          }

          input {
               margin: 20px;
               max-width: 30%;
          }
     </style>

</head>

<body onclick="removeDropdown()">

     <%- include("partials/navbar"); %>


          <div class="container-fluid">







               <div class="row">




                    <div class="col-xl-2 col-sm-12" style="background-color:whitesmoke;min-height: 100vh;padding:0px">
                         <div class="row">

                              <div class="d-flex flex-row col-12 ">
                                   <div class="p-2">
                                        <img src="https://via.placeholder.com/100x100.png?text=Profile Pic" alt="..."
                                             class="img-thumbnail">
                                   </div>
                                   <div class="p-2" style="height:100%">
                                        <h5 style="line-height: 5;">
                                             <%= user.first_name%>
                                        </h5>

                                   </div>

                              </div>


                         </div>
                         <div class="list-group" style="width:100%;margin:0px;">
                              <a href="/myaccount/<%=user._id%>" class="list-group-item list-group-item-action ">
                                   <div class="d-flex w-100">

                                        <span class="material-icons">
                                             shopping_bag
                                        </span>
                                        <p class="mb-1">My Purchases</p>
                                   </div>

                              </a>

                              <a href="/myaccount/<%=user._id%>/wishlist"
                                   class="list-group-item list-group-item-action">
                                   <div class="d-flex w-100">

                                        <span class="material-icons">
                                             favorite_border
                                        </span>
                                        <p class="mb-1">Wishlist</p>
                                   </div>

                              </a>

                              <a href="/myaccount/<%=user._id%>/rewards" class="list-group-item list-group-item-action">
                                   <div class="d-flex w-100">

                                        <span class="material-icons">
                                             redeem
                                        </span>
                                        <p class="mb-1">Nordy Rewards</p>
                                   </div>

                              </a>

                              <a href="/myaccount/<%=user._id%>/looks" class="list-group-item list-group-item-action">
                                   <div class="d-flex w-100">

                                        <span class="material-icons">
                                             looks
                                        </span>
                                        <p class="mb-1">Looks</p>
                                   </div>

                              </a>


                              <hr style="color: whitesmoke;margin:10px" />

                              <a href="/myaccount/<%=user._id%>/password"
                                   class="list-group-item list-group-item-action active">
                                   <div class="d-flex w-100">

                                        <span class="material-icons">
                                             password
                                        </span>
                                        <p class="mb-1">Password</p>
                                   </div>

                              </a>

                              <a href="/myaccount/<%=user._id%>/shipping"
                                   class="list-group-item list-group-item-action">
                                   <div class="d-flex w-100">

                                        <span class="material-icons">
                                             local_shipping
                                        </span>
                                        <p class="mb-1">Shipping Address</p>
                                   </div>

                              </a>

                              <a href="#" class="list-group-item list-group-item-action">
                                   <div class="d-flex w-100">

                                        <span class="material-icons">
                                             payment
                                        </span>
                                        <p class="mb-1">Payment Methods</p>
                                   </div>

                              </a>

                              <a href="#" class="list-group-item list-group-item-action">
                                   <div class="d-flex w-100">

                                        <span class="material-icons">
                                             email
                                        </span>
                                        <p class="mb-1">Email and Mail Preferences</p>
                                   </div>

                              </a>

                              <a href="" class="list-group-item list-group-item-action">
                                   <div class="d-flex w-100">

                                        <span class="material-icons">
                                             logout
                                        </span>
                                        <p class="mb-1">Signout</p>
                                   </div>

                              </a>
                         </div>
                    </div>
                    <div class="col-xl-10">
                         <div class="container-fluid">



                              <h4 style="line-height: 5;">Change Password</h4>







                              <form onsubmit="changePassword(event)">
                                   <input type="hidden" value="<%=user._id %>" id="user_id">

                                   <input id="new" class="form-control" type="password"
                                        placeholder="Enter New Password Here..." required>



                                   <button type="submit" class="btn btn-primary" style="margin:20px;">Change
                                        Password</button>
                              </form>




                              <div class="toast" id="myToast">
                                   <div class="toast-header">
                                        <strong class="me-auto"><i class="bi-gift-fill"></i> Password Changed</strong>
                                        <small>0 seconds ago</small>
                                   </div>

                              </div>

                         </div>
                    </div>





               </div>



               <%- include("partials/footer"); %>



                    <script>




                         async function changePassword(e) {
                              e.preventDefault();


                              let newp = document.getElementById("new").value.trim();

                              let uid = document.getElementById("user_id").value.trim();
                              var toastLiveExample = document.getElementById('liveToast')


                              console.log(uid, newp);


                              let url = "http://nordstrom-cloned.herokuapp.com/users/password/" + uid + "/update";
                              let resp = await fetch(url, ({
                                   method: "POST",
                                   headers: {
                                        'Accept': 'application/json',
                                        'Content-Type': 'application/json'
                                   },
                                   body: JSON.stringify({
                                        password: newp
                                   })
                              }));

                              let result = await resp.json()
                              if (result.status == true) {
                                   document.getElementById("new").value = null;
                                   $("#myToast").toast("show");
                              }
                              else {
                                   alert("Something went wrong our engineers are working on it !!");
                              }







                         }



                         function getOrders() {
                              console.log("changed" + document.getElementById("time").value);

                         }
                    </script>

                    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
                         integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
                         crossorigin="anonymous"></script>
                    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
                         integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
                         crossorigin="anonymous"></script>
                    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
                         integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
                         crossorigin="anonymous"></script>
</body>

</html>